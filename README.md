<h1 align="center">
    Тестовое задание Junior Golang Developer <br> Effective Mobile
</h1>

**Задача**: спроектировать и реализовать REST-сервис для агрегации данных об онлайн-подписках пользователей.

**Требования**:

1. Выставить HTTP-ручки для CRUDL-операций над записями о подписках. Каждая запись содержит:

   * Название сервиса, предоставляющего подписку
   * Стоимость месячной подписки в рублях
   * ID пользователя в формате UUID
   * Дата начала подписки (месяц и год)
   * Опционально дата окончания подписки
2. Выставить HTTP-ручку для подсчета суммарной стоимости всех подписок за выбранный период с фильтрацией по id пользователя и названию подписки
3. СУБД – PostgreSQL. Должны быть миграции для инициализации базы данных
4. Покрыть код логами
5. Вынести конфигурационные данные в .env/.yaml-файл
6. Предоставить swagger-документацию к реализованному API
7. Запуск сервиса с помощью docker compose

**Примечания**:

1. Проверка существования пользователя не требуется. Управление пользователями вне зоны ответственности вашего сервиса
2. Стоимость любой подписки – целое число рублей, копейки не учитываются
   Пример тела запроса на создание записи о подписке:

```json
{
"service_name": "Yandex Plus",
"price": 400,
"user_id": "60601fee-2bf1-4721-ae6f-7636e79a0cba",
"start_date": "07-2025"
}
```

---

<h1 align="center">
Реализация
</h1>

1. **Создание подписки**
   * Успешно - код ответа 201
   * Ошибка - коды ответов 400, 409, 500 и JSON с расшифровкой ошибки
   * Обязательно JSON с параметрами подписки
2. **Список подписок**
   * Успешно - код ответа 200 и JSON с массивом подписок
   * Ошибка - коды ответов 400, 500 и JSON с расшифровкой ошибки
   * Опцианольно в параметрах запроса можно указать фильтр с ID пользователя и/или Названием подписки
3. **Получить подписку**
   * Успешно - код ответа 200 и JSON с подписокой
   * Ошибка - коды ответов 400, 404, 500 и JSON с расшифровкой ошибки
   * Обязательны параметры в пути ID пользователя и Название подписки
4. **Изменить подписку**
   * Успешно - код ответа 200 и JSON с измененной подписокой
   * Ошибка - коды ответов 400, 404, 500 и JSON с расшифровкой ошибки
   * Обязательны параметры в пути ID пользователя и Название подписки
   * Опционально в JSON изменяемые данные: Цена и/или Дата начала подписки и/или Дата окончания подписки
5. **Удалить подписку**
   * Успешно - код ответа 200
   * Ошибка - коды ответов 400, 404, 500 и JSON с расшифровкой ошибки
   * Обязательны параметры в пути ID пользователя и Название подписки
6. **Стоимость подписок**
   * Успешно - код ответа 200 и JSON с Количеством подписок и их общей стоимостью
   * Ошибка - коды ответов 400, 500 и JSON с расшифровкой ошибки
   * Обязательны в параметрах запроса Дата начала подписки и Дата окончания подписки
   * Опцианольно в параметрах запроса можно указать фильтр с ID пользователя и/или Названием подписки

## Запуск в Docker

```
docker-compose up --build
```

Логи перенаправляются в файл в `subscriptions.log`, который находится в папке проекта в подпапке `logs`

## Доступ к API

Основное API: `http://localhost:8080/subscriptions

`

Swagger документация: `http://localhost:8080/swagger/index.html`

## Примеры запросов

1. Создание подписки:

```
curl -X POST http://localhost:8080/subscriptions \
    -H "Content-Type: application/json" \
    -d '{
       "service_name": "Yandex Plus",
        "price": 400,
        "user_id": "60601fee-2bf1-4721-ae6f-7636e79a0cba",
        "start_date": "07-2025"
    }'
```

2. Получение стоимости подписок:

```
curl "http://localhost:8080/subscriptions/total?\
    user_id=60601fee-2bf1-4721-ae6f-7636e79a0cba&\
    service_name=Yandex+Plus&\
    start_period=01-2025&\
    end_period=12-2025"
```
